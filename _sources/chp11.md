# Tableau 十一、范围-线图、倾斜图

Created: April 3, 2022 7:53 AM
Tags: Dr. Fangli Ying

### 1.范围-线图

### 1.1概念与用途

范围-线图将整体数据的部分特征（均值、最大值、最小值等）展示在图形中，既可以说明群体特征，还可以展示个体信息，更可以比较个体与整体的相对关系。

导入"人工坐席接听数据.xlsx"

在【工作表1】里，将【日期】拖到【列】，点击下拉选择【天】。

将【日期】放到【筛选器】，右击【筛选器】里的【工号】——【显示筛选器】，在右侧的工号栏里选择一个工号。

将【人工服务接听量】拖到【行】里。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/202106291656126.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/202106291656126.png)

折线图不能反映该工号员工在所有员工里的位置，而范围-线图则可以实现该目的。

### 1.2创建范围—线图

使用详细级别表达式里的fixed实现一个计算字段。

### 新建计算字段

右击【日期】——【创建】——【计算字段】。

字段名称为“接听量平均值”，公式为`{FIXED [日期]: AVG([人工服务接听量])}`

公式意思是每天的人工服务接听量平均值。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629170738249.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629170738249.png)

右击【接听量平均值】——【复制】，生成【接听量平均值 (复制)】

右击【接听量平均值 (复制)】——【编辑】，字段名改为【接听量最大值】，公式为`{FIXED [日期]: MAX([人工服务接听量])}`

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629171033200.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629171033200.png)

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629171216515.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629171216515.png)

右击【接听量平均值】——【复制】，生成【接听量平均值 (复制2)】

右击【接听量平均值 (复制2)】——【编辑】，字段名改为【接听量最小值】，公式为`{FIXED [日期]: MIN([人工服务接听量])}`

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629171346264.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629171346264.png)

### 检查计算字段

新建工作表2

将【度量名称】放到【筛选器】里，勾选【人工服务接听量】、【接听量平均值】、【接听量最大值】、【接听量最小值】、【接听量平均值】。

将【度量名称】拖到【列】

将【日期】拖到【行】选择【天】（和上面折线图一样，都是第一个“天”）。

将【度量值】放到【文本】。

点击【整个视图】。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629172006382.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629172006382.png)

选择【度量值】下的【人工服务接听量】——【度量】——【平均值】，可以发现图表里两列是一样的。

同样可以看最大值和最小值，通过比较发现确实一样，说明计算公式无误。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629172341213.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629172341213.png)

### 创建范围-线图

在【工作表1】里，将【接听量平均值】、【接听量最大值】、【接听量最小值】拖到【详细信息】上。

（只有将三者拖到详细信息上，才能在添加参考线的值里选择这三者之一。）、

（如果想要计算字段作为参考线的值，就必须放到详细信息里。）

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629173048985.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629173048985.png)

右击纵坐标轴——【添加参考线】，【线】——【每单元格】——【总和(接听量平均值)】【平均值】，标签选择【无】，线选择粗一点，黑色，点击【确定】。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629173438609.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629173438609.png)

右击纵坐标轴——【添加参考线】，【区间】——【每单元格】——区间开始选择【总和(接听量最小值)】【最小值】，标签选择【无】；区间结束选择【总和(接听量最大值)】【最大值】，标签选择【无】。

线选择粗一点，虚线，黑色，点击【确定】。这就完成了范围-线图的创建。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629210806812.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629210806812.png)

结果如下

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629211412953.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629211412953.png)

### 2.倾斜图

倾斜图用于展示单个指标在不同时期的变化。既能展示大小变化，也能展示排名变化。

### 劳动生产率变化倾斜图

打开“劳动生产率指标-2.xlsx”

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629212121680.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210629212121680.png)

新建【工作表3】。

### 计算字段

右击空白处——【创建计算字段】，字段名称改为【排名】，输入公式`INDEX()`

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630112401766.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630112401766.png)

将【期间】拖到【列】，将【排名】拖到【行】

点击【整个视图】

选择【标记】下【自动】里的【线】。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630112609548.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630112609548.png)

### 添加表计算

将【单位】拖到【详细信息】

点击【行】里【排名】下拉框——【添加表计算】。

在【表计算】里，【特定维度】勾选【期间】和【单位】，【排序顺序】选择【自定义】【累计值】【总和】【升序】。

（勾选【单位】是按单元格进行计算）

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630113129196.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630113129196.png)

点击【行】里【排名】下拉框——【编辑表计算】。

【重新启动间隔】里选择【期间】。

（可以对比一下上边选择【无】的区别，选择【无】是整体排序，选择【期间】是按左右期间分别排序。）

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630113711956.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630113711956.png)

将【排名】拖到【标签】上。

右击标签的【排名】——【添加表计算】，内容设置同上。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630114326890.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630114326890.png)

### 设置标签

将【单位】和【累计值】拖到【标签】上

点击【标签】，点击【文本】旁的…，将三个标签排成一行，点击确定；点击【线末端】，勾选三个选项。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630114903716.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630114903716.png)

### 降序排列

点击【排名】——【复制】

点击【排名(复制)】——【编辑】，修改字段名为【排名-正确】，公式为`17-INDEX()`

(为什么选17，因为序号是17-16=1,17-15=2…17-1=16)

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630115435912.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630115435912.png)

将【排名】从【标记】上拖开。

将【排名-正确】拖到【标签】上，右击【排名-正确】——【编辑表计算】，内容设置同上。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630115925759.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630115925759.png)

### 修改标签

图表的标签顺序错误，重新修改。

点击【标签】，点击【文本】旁的…，将三个标签排成一行，点击确定；点击【线末端】，勾选三个选项。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630120212958.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630120212958.png)

### 调整线粗细

右击空白处——【创建计算字段】，字段名称改为【变化量】，输入公式`LOOKUP(SUM([累计值]),LAST())-LOOKUP(SUM([累计值]),FIRST())`

将【变化量】拖到【大小】上。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630120859222.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630120859222.png)

### 调整线颜色

在【度量】下空白处右击【创建计算字段】，字段名为【增减状态标志】，公式为

```
IF [变化量] >0 THEN "增长"
ELSEIF [变化量]=0 THEN "持平"
ELSE "下降" END

```

将【增减状态标志】拖到【颜色】上。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630135751654.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630135751654.png)

### 负值换算成绝对值

问题：像浙江下降非常厉害，但是线却非常细，实际上应该非常粗才对，也即是负值应该按绝对值来排序。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630140146154.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630140146154.png)

在【度量】下空白处右击【创建计算字段】，字段名为【变化量绝对值】，公式为`ABS([变化量])`

将【标记】下的【变化量】拖走，将【变化量绝对值】拖到【大小】上。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630140821336.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630140821336.png)

### 调整当期和同期顺序

为方便阅读，需要将当期调到右边。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630141243144.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630141243144.png)

右击【列】里的【期间】——【排序】。

选择【手动排序】，将【当期】下移到下边。

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630141445853.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630141445853.png)

结果如下：

![Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630141833322.png](Tableau%20%E5%8D%81%E4%B8%80%202a767/20210630141833322.png)

### 注意事项

变化量使用lookup `LOOKUP(SUM([累计值]),LAST())-LOOKUP(SUM([累计值]),FIRST())`

排名顺序需要重新计算

标签在使用的时候需要重新排版

用绝对值来显示变化量的大小，用颜色来区分增长或减小。