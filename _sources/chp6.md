# Tableau 六、填充地图、多维地图、混合地图

Created: April 3, 2022 7:52 AM
Tags: Dr. Fangli Ying

### 1.填充地图

### 1.1 各省售电量填充地图

打开`2014年各省市售电量.xlsx`

修改【工作表】为‘各省售电量填充地图’。

### 修改地理数据信息

右击【省市】——【地理角色】——【省/市/自治区】

右击【地市】——【地理角色】——【城市】

![Tableau%20%E5%85%AD%E3%80%81%209b720/20210622113703316.png](Tableau%20%E5%85%AD%E3%80%81%209b720/20210622113703316.png)

双击【省份】，出现地图。

![Tableau%20%E5%85%AD%E3%80%81%209b720/20210622114006573.png](Tableau%20%E5%85%AD%E3%80%81%209b720/20210622114006573.png)

将【当期值】拖到【颜色】上，生成填充地图。以地理为单位进行颜色填充。

![Tableau%20%E5%85%AD%E3%80%81%209b720/6950ef327c514b8ab9ca23ae8b68576c.png](Tableau%20%E5%85%AD%E3%80%81%209b720/6950ef327c514b8ab9ca23ae8b68576c.png)

右击【颜色】——【填充颜色】——【色板】选择【红色-蓝色发散】，勾选【倒序】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/1420e7131f20435082007ecdb88be855.png](Tableau%20%E5%85%AD%E3%80%81%209b720/1420e7131f20435082007ecdb88be855.png)

### 处理未知

点击【未知】，在【匹配位置】下选择合适的省份，点击【确定】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/188e8f077c2c4b37b8ccf8d0b76d8349.png](Tableau%20%E5%85%AD%E3%80%81%209b720/188e8f077c2c4b37b8ccf8d0b76d8349.png)

### 修改标签

将【省市】拖到【标签】上。

如果标签位置不合适，比如【甘肃】，可以将标签移动位置。

![Tableau%20%E5%85%AD%E3%80%81%209b720/e2e2c9811a504b6ca866b07ccace9408.png](Tableau%20%E5%85%AD%E3%80%81%209b720/e2e2c9811a504b6ca866b07ccace9408.png)

黑龙江省只显示了【龙江】，在黑龙江省的地理位置上右击【添加注释】——【标记】，在对话框里输入【黑龙江】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/63e3050f33d24348991e0d526d730463.png](Tableau%20%E5%85%AD%E3%80%81%209b720/63e3050f33d24348991e0d526d730463.png)

右击【黑龙江】——【设置格式】，在左边的【设置格式】栏里，设置【框】、【阴影】和【边界】为无。

![Tableau%20%E5%85%AD%E3%80%81%209b720/9931c47887cb49138ba3a1e96e1c6a54.png](Tableau%20%E5%85%AD%E3%80%81%209b720/9931c47887cb49138ba3a1e96e1c6a54.png)

右击黑龙江省的地理位置，【标记标签】——【从不显示】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/b07c1a1d1ca44ac4ba7568d512412e81.png](Tableau%20%E5%85%AD%E3%80%81%209b720/b07c1a1d1ca44ac4ba7568d512412e81.png)

同样方式修改【蒙东】为【内蒙古】。

### 对准地理图形中心

在图形上，滑动鼠标滚轮，图形可以放大缩小。但始终对不准中心。

点击左上角的【重置地图】，可以将地图调到中心，重置地图位置。

![Tableau%20%E5%85%AD%E3%80%81%209b720/7414810c21f040c98336cedffd49e4c7.png](Tableau%20%E5%85%AD%E3%80%81%209b720/7414810c21f040c98336cedffd49e4c7.png)

### 1.2地图格式设置

点击【地图】——【地图层】。

主要使用【样式】、【侵蚀】和【国家/地区名称】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/e4effb13f7aa43f6a6d7ddc7a9b60732.png](Tableau%20%E5%85%AD%E3%80%81%209b720/e4effb13f7aa43f6a6d7ddc7a9b60732.png)

### 样式

样式选【普通】，就发现地图的海水变了颜色。

![Tableau%20%E5%85%AD%E3%80%81%209b720/5e61f222c8bf4739ac96c1ea05f13d34.png](Tableau%20%E5%85%AD%E3%80%81%209b720/5e61f222c8bf4739ac96c1ea05f13d34.png)

样式选【黑色】，就发现地图变成了黑色，一般黑色用于夜间分析。

![Tableau%20%E5%85%AD%E3%80%81%209b720/08af0bb4062745adbf2909c7c9973ead.png](Tableau%20%E5%85%AD%E3%80%81%209b720/08af0bb4062745adbf2909c7c9973ead.png)

### 冲蚀

【冲蚀】可以降低图表颜色。一般会选择100%冲蚀，这样将不相关的地理位置去掉。

![Tableau%20%E5%85%AD%E3%80%81%209b720/cb036efcd19e4176bf9ab9cf6c1249c7.png](Tableau%20%E5%85%AD%E3%80%81%209b720/cb036efcd19e4176bf9ab9cf6c1249c7.png)

### 底图

取消勾选【底图】，发现背景位置发白。

![Tableau%20%E5%85%AD%E3%80%81%209b720/7ca14328f8734826b2094c26d412b65c.png](Tableau%20%E5%85%AD%E3%80%81%209b720/7ca14328f8734826b2094c26d412b65c.png)

### 【国家/地区名称】

勾选【海岸线】，则显示海岸线。

取消勾选【国家/地区名称】，则取消背景地图的国家/地区的名称显示。

![Tableau%20%E5%85%AD%E3%80%81%209b720/3b73a7278ec24b22baca8505f6509c6b.png](Tableau%20%E5%85%AD%E3%80%81%209b720/3b73a7278ec24b22baca8505f6509c6b.png)

【冲蚀】调到100%，填充地图完成。

![Tableau%20%E5%85%AD%E3%80%81%209b720/329f0c7cba754a3897a2bbc53ccad10b.png](Tableau%20%E5%85%AD%E3%80%81%209b720/329f0c7cba754a3897a2bbc53ccad10b.png)

### 2.多维地图

一张张地图形成矩阵形式，就是多维地图。

### 2.1各省市售电量的多维地图

新建工作表，命名为【各省市售电量的多维地图】

### 前期准备

双击【省份】，出现地图。

将【当期值】拖到【颜色】上，生成填充地图。以地理为单位进行颜色填充。

右击【颜色】——【填充颜色】——【色板】选择【红色-绿色发散】，勾选【倒序】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/f64e97f78be048cbb6055ee29cb6b9ba.png](Tableau%20%E5%85%AD%E3%80%81%209b720/f64e97f78be048cbb6055ee29cb6b9ba.png)

### 多维地图

将【用电类别】拖到【列】中。

![Tableau%20%E5%85%AD%E3%80%81%209b720/9b06d4908369401ea4d13708758d52b7.png](Tableau%20%E5%85%AD%E3%80%81%209b720/9b06d4908369401ea4d13708758d52b7.png)

【地图】——【地图层】，冲蚀选择100%，取消勾选【国家/地区名称】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/bf335193b94b448d80f2953ef78748bc.png](Tableau%20%E5%85%AD%E3%80%81%209b720/bf335193b94b448d80f2953ef78748bc.png)

将【统计周期】放到【行】中，点击【年(统计周期)】中的+按钮，生成【季度(统计周期)】。

点击【季度(统计周期)】中的+按钮，生成【月(统计周期)】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/b0543ac7e7634c64977d2597724b7e91.png](Tableau%20%E5%85%AD%E3%80%81%209b720/b0543ac7e7634c64977d2597724b7e91.png)

### 调整类别顺序

【工作表】——【导出】——【图像】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/a4402e9b2e0348e59229696b04ae5ce4.png](Tableau%20%E5%85%AD%E3%80%81%209b720/a4402e9b2e0348e59229696b04ae5ce4.png)

发现图片有问题

- 标签比较小，需要增大。
- 【汇总】应该放最后。
- 【商业】等应放前面。
    
    ![Tableau%20%E5%85%AD%E3%80%81%209b720/f237b98b98aa43e2959d09c8d7d84eef.png](Tableau%20%E5%85%AD%E3%80%81%209b720/f237b98b98aa43e2959d09c8d7d84eef.png)
    

右击【用电类别】——【排序】

![Tableau%20%E5%85%AD%E3%80%81%209b720/4b29c98fb4754ccfafc5989539ace596.png](Tableau%20%E5%85%AD%E3%80%81%209b720/4b29c98fb4754ccfafc5989539ace596.png)

打开【排序】对话框，在【手动】里【下移】字段【汇总】到最下面，【上移】字段【商业】到第2位，点击【应用】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/20210622142849336.png](Tableau%20%E5%85%AD%E3%80%81%209b720/20210622142849336.png)

### 修改横竖坐标轴

修改横坐标轴，右击图形里的【商业】——【设置格式】，在【字体】的下拉框里选择粗体。

修改竖坐标轴，右击图形里【月(统计周期)】——【设置格式】，在【字体】的下拉框里选择粗体。

![Tableau%20%E5%85%AD%E3%80%81%209b720/1219bc09a8ec4a37a25980214fa64adb.png](Tableau%20%E5%85%AD%E3%80%81%209b720/1219bc09a8ec4a37a25980214fa64adb.png)

【工作表】——【导出】——【图像】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/d1d052fbd2744ce6b0ed3ee5bb94fe3d.png](Tableau%20%E5%85%AD%E3%80%81%209b720/d1d052fbd2744ce6b0ed3ee5bb94fe3d.png)

![Tableau%20%E5%85%AD%E3%80%81%209b720/d448491cc1d44a059d8ad8675c5b1a97.png](Tableau%20%E5%85%AD%E3%80%81%209b720/d448491cc1d44a059d8ad8675c5b1a97.png)

分析：

从用电类别上上看，大工业用电最多，电厂直供用电最少。

从用电时间上看，一月份、四月份、五月份、六月份多，二、三月份少。

### 【隐藏字段】

如果觉得标红部分不需要，可以右击【隐藏行字段标签】。隐藏后也不影响理解图表。

![Tableau%20%E5%85%AD%E3%80%81%209b720/8f4f91d1872044e7bc6fa5473ab970fe.png](Tableau%20%E5%85%AD%E3%80%81%209b720/8f4f91d1872044e7bc6fa5473ab970fe.png)

### 3.混合地图

混合地图是将地图和其他图表比如饼图、条形图、符号地图等结合。

### 3.1 各省市售电量混合地图

各省市售电量混合地图是将地图和符号地图结合。

### 前期准备

双击【省份】，出现地图。

将【当期值】拖到【颜色】上，生成填充地图。以地理为单位进行颜色填充。

右击【颜色】——【填充颜色】——【色板】选择【红色-蓝色发散】，勾选【倒序】。

将【省市】放到【标签】上。

【地图】——【地图层】，冲蚀选择100%。

![Tableau%20%E5%85%AD%E3%80%81%209b720/65ad750a2bab4a35b713e5b7bf4ca6c8.png](Tableau%20%E5%85%AD%E3%80%81%209b720/65ad750a2bab4a35b713e5b7bf4ca6c8.png)

### 混合地图

混合地图做法类似环形图做法。

按住ctrl键，复制【行】中的【纬度】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/9c60631c57e147a79ea1f491fc2dc3c6.png](Tableau%20%E5%85%AD%E3%80%81%209b720/9c60631c57e147a79ea1f491fc2dc3c6.png)

右击【纬度】——【双轴】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/82da6d27d91b474c8bdc478223da01b0.png](Tableau%20%E5%85%AD%E3%80%81%209b720/82da6d27d91b474c8bdc478223da01b0.png)

将【度量】下的【同期值】放入【标记】下【纬度(生成)(2)】中的【大小】里，将【总和(当期值)】拖走。

![Tableau%20%E5%85%AD%E3%80%81%209b720/db852b1d862d406fac2d9c5163af7664.png](Tableau%20%E5%85%AD%E3%80%81%209b720/db852b1d862d406fac2d9c5163af7664.png)

将【标记】下【纬度(生成)】中的【省市】标签拖走。这样图表里的省市标签不会重复，而且不会遮盖当期值形成的圆形符号。

![Tableau%20%E5%85%AD%E3%80%81%209b720/3b0693a3620a4109bbc54e60fd382359.png](Tableau%20%E5%85%AD%E3%80%81%209b720/3b0693a3620a4109bbc54e60fd382359.png)

调整【总和(当期值)】的大小和颜色，颜色比如为绿色。

![Tableau%20%E5%85%AD%E3%80%81%209b720/e5e6928d48574292a45c07c843c02837.png](Tableau%20%E5%85%AD%E3%80%81%209b720/e5e6928d48574292a45c07c843c02837.png)

##### 增加维度

将【同期累计值】拖至【颜色】上，则圆形的颜色深浅表示总和(同期累计值)，而圆形的大小表示总和(同期值)。

![Tableau%20%E5%85%AD%E3%80%81%209b720/294f0a0c0c1b44109b2aa3330c3a5975.png](Tableau%20%E5%85%AD%E3%80%81%209b720/294f0a0c0c1b44109b2aa3330c3a5975.png)

调整【纬度(生成)(2)】下【同期累计值】的【颜色】，【红色-绿色发散】，勾选【倒序】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/d00fd2549c6a457f884055caa416315e.png](Tableau%20%E5%85%AD%E3%80%81%209b720/d00fd2549c6a457f884055caa416315e.png)

调整【纬度(生成)】下【当期值】的【颜色】，【蓝色】，取消勾选【倒序】。

![Tableau%20%E5%85%AD%E3%80%81%209b720/3c8ef661a196492d8e90da36299abca2.png](Tableau%20%E5%85%AD%E3%80%81%209b720/3c8ef661a196492d8e90da36299abca2.png)

混合地图搞定。这个混合地图包含3个维度。用地理位置的深浅表示当期值，用符号圆形的大小表示同期值的大小，用符号圆形的颜色深浅表示同期累计值。

![Tableau%20%E5%85%AD%E3%80%81%209b720/fbf3a8417ada40e0a17f348049442f6c.png](Tableau%20%E5%85%AD%E3%80%81%209b720/fbf3a8417ada40e0a17f348049442f6c.png)

也可以做饼图，设置如下：

![Tableau%20%E5%85%AD%E3%80%81%209b720/7aa25622df25459b8594bf55fd7731fe.png](Tableau%20%E5%85%AD%E3%80%81%209b720/7aa25622df25459b8594bf55fd7731fe.png)