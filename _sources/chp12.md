# Tableau 十二、网络图与弧线图

Created: April 3, 2022 7:53 AM
Tags: Dr. Fangli Ying

### 1.网络图

### 1.1简单的网络图

打开“五点位置关系信息.xlsx”

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701085337271.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701085337271.png)

### 创建网络图

在【工作表1】，将【X】拖到【列】，将【Y】拖到【行】

【分析】——取消勾选【聚合度量】

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701085723200.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701085723200.png)

【标记】下选择【线】，将【关联】拖到【路径】上。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701085950222.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701085950222.png)

### 添加标签

按住ctrl，拖动【行】里【Y】进行复制。

【标记】下【总和(Y)(2)】的【自动】里选择【形状】，【形状】里选择实心圆圈。

将【点】拖到【总和(Y)(2)】的【标签】上。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701090343714.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701090343714.png)

点击【总和(Y)(2)】的【标签】，勾选【允许标签覆盖其他标记】

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701090615406.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701090615406.png)

右击图标里下方图表的纵轴——【双轴】

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701090845678.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701090845678.png)

显示如下

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701091005544.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701091005544.png)

图表中挪动C点位置，发现有两个C

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701091345615.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701091345615.png)

右击图表里的C点——【标记标签】——【从不显示】。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701091440269.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701091440269.png)

重命名【工作表1】为【五点网络图】，最终结果如下

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701091923238.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701091923238.png)

### 1.2创建各省份关系的网络图

打开“province_relationship.xlsx”，右击隐藏【F1】字段。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701092108777.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701092108777.png)

### 创建网络图

新建【工作表2】

双击【Latitude】，再双击【Longitude】，打开了地图。

【分析】——取消勾选【聚合度量】。

按住ctrl，滚动滑轮可以缩放地图大小。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701092358608.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701092358608.png)

【标记】下选择【线】，将【relationship】拖到【路径】上。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701092828778.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701092828778.png)

### 添加标签

按住ctrl，拖动【行】里【Latitude】进行复制。

【标记】下【平均值(Latitude)(2)】的【自动】里选择【形状】，【形状】——【更多形状】里选择自己的自定义形状。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/2021070109384292.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/2021070109384292.png)

将【province】拖到【平均值(Latitude)(2)】的【标签】上

点击【平均值(Latitude)(2)】的【标签】，勾选【允许标签覆盖其他标记】

将【province】拖到【平均值(Latitude)(2)】的【颜色】上。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701094328809.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701094328809.png)

点击【Latitude】里下拉框【双轴】

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701094559959.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701094559959.png)

【平均值(Latitude)(2)】的【大小】，调整自定义形状的大小

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701094717305.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701094717305.png)

### 修改地图层

点击【地图】——【地图层】。

【样式】选择【普通】，【冲蚀】选择【15%】，取消【地图层】中【国家/地区名称】勾选。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701095107932.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701095107932.png)

### 将地图网络关系图改为普通网络图

点击【Latitude】——【地理角色】——【无】。

点击【Longitude】——【地理角色】——【无】。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701095550907.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701095550907.png)

### 复原为地图网格关系图

点击【Latitude】——【地理角色】——【纬度】。

点击【Longitude】——【地理角色】——【经度】。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701095834681.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701095834681.png)

重命名【工作表2】为【省份关系网络图】。

### 1.3线路方式创建网络图

点击此处可以返回数据源。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701101020371.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701101020371.png)

导入“线路数据.xlsx”

可以看出【线路】的数据方式跟上面不一样，是通过`<->`形式连接两点。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/2021070110112590.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/2021070110112590.png)

### 创建网络图

新建【工作表3】

将【X】拖到【列】，将【Y】拖到【行】

【分析】——取消勾选【聚合度量】

将【线路】直接拖到【标记】下。（这个是和前面不一样的地方，要注意）

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701101447847.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701101447847.png)

### 添加标签

按住ctrl，拖动【行】里【Y】进行复制。

【标记】下【总和(Y)(2)】的【自动】里选择【形状】，【形状】里选择实心圆圈。

点击【行】里的最右边的【Y】下拉框——【双轴】。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701101849282.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701101849282.png)

### 修改线路颜色

将【使用率】放到【标记】下【总和(Y)】的【颜色】上。

点击【颜色】——【编辑颜色】，选择【红色-蓝色发散】，勾选【倒序】。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701102414388.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701102414388.png)

将【站点】拖到【总和(Y)(2)】下的【颜色】上。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701102709658.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701102709658.png)

将【站点】拖到【总和(Y)(2)】下的【标签】上。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701103023685.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701103023685.png)

重命名【工作表3】为【线路关系图】。

### 总结

每个网络图都是由两部分组成：点、线。

网络图是通过双轴合成的

点与点的表达形式有两种：通过数字；通过`<->`

### 2.弧线图

弧线图是通过弧度长度表示量的大小。

### 2.1创建表格

### 创建条形图

导入数据“酒店数据.xlsx”

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701103823133.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701103823133.png)

新建【工作表4】

将【地区】拖到【列】，将【记录数】拖到【行】。

点击【降序】。

点击图标里的【其他】——【排除】。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701104356670.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701104356670.png)

框选或者按ctrl，选择前六个——【只保留】。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701104649323.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701104649323.png)

### 创建表格

打开Excel，命名为“酒店角度.xlsx”

表格里需要创建角度、地区、分类、酒店数量。

角度通过百分占比求出。

地区是弧度名称。

分类在环里的第几环。

【离岛】数量最少，在弧线的最里面。

右击【总和(记录数)】——【快速表计算】——【合计百分比】。

右击【总和(记录数)】——【设置格式】，【数字】——【百分比】，小数位数为0。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701105623239.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701105623239.png)

从中看出【离岛】的百分比是4%，则在excel表格里如下，从0到3共4个数字。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701110026969.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701110026969.png)

【东区】是5%，则从0-4共5个数字。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701110227367.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701110227367.png)

其他类推。

【分类】是按照由小到大的排列的。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701111012418.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701111012418.png)

将【记录数】拖到【标签】上，显示出酒店数量。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701111115337.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701111115337.png)

在excel表格里填入数据。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701111351973.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701111351973.png)

### 2.2创建弧线图

导入““酒店角度.xlsx””

新建【工作表5】

### 圆坐标公式说明

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701143730299.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701143730299.png)

### 创建计算字段

【维度】下空白处右击——【创建计算字段】，字段名为【X坐标】，公式为`[分类]*COS([角度]*PI()/180)`

复制字段【X坐标】，重命名为【Y坐标】，公式为`[分类]*SIN([角度]*PI()/180)`

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701112509614.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701112509614.png)

将【X坐标】拖到【列】，将【Y坐标】拖到【行】

【标记】下【自动】选择【线】，将【地区】拖到【颜色】上。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701113606408.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701113606408.png)

### 2.3调整弧线图参数

### 修改尺寸

调整【大小】，弧线变粗。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701113840937.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701113840937.png)

调整计算字段【X坐标】的公式为`[分类]*COS([角度]*PI()/90)`

调整计算字段【Y坐标】的公式为`[分类]*SIN([角度]*PI()/90)`

这样，弧线就变长了。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701114135125.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701114135125.png)

右击图表里横坐标轴——【编辑轴】，点击【固定】，固定开始为【-7】，固定结束为【7】

右击图表里纵坐标轴——【编辑轴】，点击【固定】，固定开始为【-7】，固定结束为【7】

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701114436471.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701114436471.png)

调整计算字段【X坐标】的公式为`[分类]*COS([角度]*PI()/45)`

调整计算字段【Y坐标】的公式为`[分类]*SIN([角度]*PI()/45)`

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/2021070111480382.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/2021070111480382.png)

将【角度】放到【路径】里

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/2021070111485988.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/2021070111485988.png)

### 调整方向

调整计算字段【X坐标】的公式为`[分类]*COS([角度]*PI()/45+PI()/2)`

调整计算字段【Y坐标】的公式为`[分类]*SIN([角度]*PI()/45+PI()/2)`

（注意，加上一个PI，是调整180度，加上半个PI，是调整90度）

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701115306608.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701115306608.png)

调整计算字段【X坐标】的公式为`-[分类]*COS([角度]*PI()/45+PI()/2)`

（注意加上-，形成了镜像反转）

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701115659846.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701115659846.png)

### 添加标签

将【地区】拖到【标签】上。

点击【标签】——【线末端】，勾选【允许标签覆盖其他标记】和【线首标签】

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701120005202.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701120005202.png)

将【酒店数量】拖到【标签】上

点击【标签】——【文本】旁的…，调整标签位置。

![Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701120229789.png](Tableau%20%E5%8D%81%E4%BA%8C%200eaaa/20210701120229789.png)

修改【工作表5】为【酒店弧线图】

### 总结

记住X、Y公式

分类代表第几环

根据公式调整线条弧度和角度

要把地区放到【颜色】上，把【角度】放到【路径】上